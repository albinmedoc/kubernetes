csiDriver:
  name: "org.democratic-csi.truenas-iscsi"

storageClasses:
  - name: truenas-iscsi
    defaultClass: false
    reclaimPolicy: Delete
    volumeBindingMode: Immediate
    allowVolumeExpansion: true
    parameters:
      fsType: ext4
      detachedVolumesFromSnapshots: "false"
    mountOptions: []
    secrets:
      provisioner-secret:
      controller-publish-secret:
      node-stage-secret:
      node-publish-secret:
      controller-expand-secret:

controller:
  driver:
    image:
      tag: next

node:
  hostPID: true
  driver:
    extraEnv:
      - name: ISCSIADM_HOST_STRATEGY
        value: nsenter
      - name: ISCSIADM_HOST_PATH
        value: /usr/local/sbin/iscsiadm
    iscsiDirHostPath: /etc/iscsi
    iscsiDirHostPathType: ""

driver:
  config:
    driver: freenas-api-iscsi
    httpConnection:
      protocol: http
      host: 192.168.86.109
      port: 80
      apiKey: APITOKEN
      allowInsecure: true
    zfs:
      datasetParentName: Datapool1/k8s/iscsi/vols
      detachedSnapshotsDatasetParentName: Datapool1/k8s/iscsi/snaps
      zvolEnableReservation: false
      zvolBlocksize: 16K
    iscsi:
      targetPortal: "192.168.86.109:3260"
      targetPortals: []
      interface:
      namePrefix: csi-
      nameSuffix: "-talos"
      targetGroups:
        - targetGroupPortalGroup: 1
          targetGroupInitiatorGroup: 2
          targetGroupAuthType: None
      extentInsecureTpc: true
      extentXenCompat: false
      extentDisablePhysicalBlocksize: true
      extentBlocksize: 512
      extentRpm: "SSD"
      extentAvailThreshold: 0